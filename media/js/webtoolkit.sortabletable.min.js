function SortableTable(a,f,c){this.tbody=a.getElementsByTagName("tbody");this.thead=a.getElementsByTagName("thead");this.tfoot=a.getElementsByTagName("tfoot");this.HasClassName=function(m,n){if(m.className){var h=m.className.split(" ");var l=n.toUpperCase();for(var k=0;k<h.length;k++){if(h[k].toUpperCase()==l){return true}}}return false};this.AddClassName=function(n,o,h){if(n.className){var k=n.className.split(" ");if(h){var m=o.toUpperCase();for(var l=0;l<k.length;l++){if(k[l].toUpperCase()==m){k.splice(l,1);l--}}}k[k.length]=o;n.className=k.join(" ")}else{n.className=o}};this.RemoveClassName=function(m,n){if(m.className){var h=m.className.split(" ");var l=n.toUpperCase();for(var k=0;k<h.length;k++){if(h[k].toUpperCase()==l){h.splice(k,1);k--}}m.className=h.join(" ")}};this.getInnerText=function(h){if(typeof(h.textContent)!="undefined"){return h.textContent}if(typeof(h.innerText)!="undefined"){return h.innerText}if(typeof(h.innerHTML)=="string"){return h.innerHTML.replace(/<[^<>]+>/g,"")}};this.getParent=function(i,h){if(i==null){return null}else{if(i.nodeType==1&&i.tagName.toLowerCase()==h.toLowerCase()){return i}else{return this.getParent(i.parentNode,h)}}};this.sort=function(h){var n=h.cellIndex;var p=this.getInnerText(this.tbody[0].rows[1].cells[n]);var m=this.sortCaseInsensitive;if(p.match(/\d\d[-]+\d\d[-]+\d\d\d\d/)){m=this.sortDate}if(p.replace(/^\s+|\s+$/g,"").match(/^-?[\d\.]+$/)){m=this.sortNumeric}this.sortColumnIndex=n;var l=new Array();for(j=0;j<this.tbody[0].rows.length;j++){l[j]=this.tbody[0].rows[j]}l.sort(m);for(var k=0;k<g.cells.length;k++){var o=g.cells[k];if(f!=null){if(this.HasClassName(o,f)){this.RemoveClassName(o,f)}}if(c!=null){if(this.HasClassName(o,c)){this.RemoveClassName(o,c)}}}if(h.getAttribute("sortdir")=="down"){l.reverse();h.setAttribute("sortdir","up");if(f!=null){if(this.HasClassName(h,f)){this.RemoveClassName(h,f)}}if(c!=null){this.AddClassName(h,c,true)}}else{h.setAttribute("sortdir","down");if(c!=null){if(this.HasClassName(h,c)){this.RemoveClassName(h,c)}}if(f!=null){this.AddClassName(h,f,true)}}for(k=0;k<l.length;k++){this.tbody[0].appendChild(l[k])}};this.sortCaseInsensitive=function(i,h){aa=b.getInnerText(i.cells[b.sortColumnIndex]).toLowerCase();bb=b.getInnerText(h.cells[b.sortColumnIndex]).toLowerCase();if(aa==bb){return 0}if(aa<bb){return -1}return 1};this.sortDate=function(i,h){aa=b.getInnerText(i.cells[b.sortColumnIndex]);bb=b.getInnerText(h.cells[b.sortColumnIndex]);date1=aa.substr(6,4)+aa.substr(3,2)+aa.substr(0,2);date2=bb.substr(6,4)+bb.substr(3,2)+bb.substr(0,2);if(date1==date2){return 0}if(date1<date2){return -1}return 1};this.sortNumeric=function(i,h){aa=parseFloat(b.getInnerText(i.cells[b.sortColumnIndex]));if(isNaN(aa)){aa=0}bb=parseFloat(b.getInnerText(h.cells[b.sortColumnIndex]));if(isNaN(bb)){bb=0}return aa-bb};var b=this;var e=this.thead;if(!(this.tbody&&this.tbody[0].rows&&this.tbody[0].rows.length>0)){return}if(e&&e[0].rows&&e[0].rows.length>0){var g=e[0].rows[0]}else{return}for(var d=0;d<g.cells.length;d++){g.cells[d].sTable=this;g.cells[d].onclick=function(){this.sTable.sort(this);return false}}};