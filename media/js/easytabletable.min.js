var et_name="";var $et_check_msg="";var $et_give_data_type_change_warning=true;if(typeof jQuery==="undefined"){window.addEvent("load",function(){$("jform_params_id").addEvent("change",function(c){var a=$("jform_params_key_field");var b=$("jform_params_linked_key_field");a.selectedIndex=0;a.options[0].set("text",Joomla.JText._("COM_EASYTABLEPRO_MODEL_FIELDS_SAVE_TABLE_SELECTION"));com_EasyTablePro.Tools.removeOptions(a,1);b.selectedIndex=0;b.options[0].set("text",Joomla.JText._("COM_EASYTABLEPRO_MODEL_FIELDS_SAVE_TABLE_SELECTION"));com_EasyTablePro.Tools.removeOptions(b,1)})})}else{jQuery(document).ready(function(){jQuery("#jform_params_id").change(function(c){var a=jQuery("#jform_params_key_field");var b=jQuery("#jform_params_linked_key_field");a.find("option:eq('')").text(Joomla.JText._("COM_EASYTABLEPRO_MODEL_FIELDS_SAVE_TABLE_SELECTION"));com_EasyTablePro.Tools.removeOptions(a,1);a.val("").trigger("liszt:updated");b.find("option:eq('')").text(Joomla.JText._("COM_EASYTABLEPRO_MODEL_FIELDS_SAVE_TABLE_SELECTION"));com_EasyTablePro.Tools.removeOptions(b,1);b.val("").trigger("liszt:updated")})})}com_EasyTablePro.Table.atLeast1ListField=function(){var d=document.adminForm;var f=d.elements.length;var b;var e;var a;for(var c=0;c<f;c++){e=d.elements[c].name;if(e){b=String(e).indexOf("list_view");if(b>=0){a=!!(+d.elements[c].value);if(a){return true}}}}et_name=$("jform_easytablename").value;$et_check_msg=com_EasyTablePro.Tools.sprintf(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_AT_LEAST_ONE"),et_name);return false};com_EasyTablePro.Table.AliassAreUnique=function(){if(document.adminForm.elements.et_linked_et.value){return true}var h=$("mRIds");if(typeof h!=="undefined"){var e=$("mRIds").value;e=e===""?"":"fieldalias"+e;e=e.split(", ").join(", fieldalias").split(", ");var j=$("newFlds");var d="";if((typeof j!=="undefined")&&(j.value!=="")){d=j.value;d=d===""?"":"fieldalias_nf_"+d;d=d.split(", ").join(", fieldalias_nf_").split(", ")}var l="";if(d!==""){l=e.concat(d)}else{l=e}var b=[];var a;var c;var k;var g;for(var f=0;f<l.length;f++){a=l[f];c=document.adminForm.elements[a].value;document.adminForm.elements[a].focus();if(c===""){k=a.substring(10);g="label"+k;g=$(g).name;$et_check_msg=com_EasyTablePro.Tools.sprintf(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_FIELD_ALIAS_CAN_NOT_BE_EMPTY"),g,k);return false}b.push(c)}b=b.sort();for(f=0;f<b.length;f++){if(b[f+1]===b[f]){$et_check_msg=com_EasyTablePro.Tools.sprintf(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_FIELD_ALIAS_MUST_BE_UNIQUE"),b[f]);return false}}return true}return false};com_EasyTablePro.Table.changeTypeWarning=function(){if($et_give_data_type_change_warning){$et_give_data_type_change_warning=false;alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_CHANGING_FIELD_TYPE"))}};com_EasyTablePro.Table.unlock=function(c,e){var a;var d;if(typeof jQuery==="undefined"){a="fieldalias"+e;d=(document.getElementsByName(a))[0];var b=location.protocol+"//"+location.host;var g=b+"/media/com_easytablepro/images/locked.gif";var f=b+"/media/com_easytablepro/images/unlocked.gif";if(d.disabled){c.src=f;d.disabled=false;d.focus();d.select()}else{c.src=g;d.disabled=true}}else{a="fieldalias"+c.id.substr(6,c.id.length);d=(document.getElementsByName(a))[0];if(d.disabled){d.disabled=false;d.focus();d.select();c.firstChild.addClass("icon-locked");c.firstChild.removeClass("icon-pencil")}else{d.disabled=true;c.firstChild.addClass("icon-pencil");c.firstChild.removeClass("icon-locked")}}};com_EasyTablePro.Table.toggleTick=function(tFieldName,tRow,tImgSuffix){if(typeof jQuery!=="undefined"){var btn=tFieldName;var params=btn.id.split(".");tFieldName=params[0];tRow=params[2]}tImgSuffix=typeof tImgSuffix==="undefined"?"_img":tImgSuffix;var tFieldNameRow=tFieldName+tRow;var tImageName=tFieldNameRow+tImgSuffix;var tFieldElementId=eval("document.adminForm."+tFieldNameRow);var tFieldImageElementId=eval("document."+tImageName);if(tFieldElementId.value==="1"){tFieldImageElementId.src="/media/com_easytablepro/images/publish_x.png";tFieldElementId.value="0"}else{tFieldImageElementId.src="/media/com_easytablepro/images/tick.png";tFieldElementId.value="1"}};com_EasyTablePro.Table.firstAvailableNumber=function(e,d){d=(typeof d==="undefined")?1:d;var a=e.split(", ");a.sort(function(g,f){return g-f});for(var c=0;c<a.length;c++){var b=parseInt(a[c],10);if(d===b){d++}if(d<b){break}}return d};com_EasyTablePro.Table.aliasOK=function(a){if(a===""){alert(Joomla.JText._("The alias can not be empty (nor should it contain spaces or other characters not suitable for use in URLs."));return false}if(a!==com_EasyTablePro.Tools.makeURLSafe(a)){alert(Joomla.JText._("The alias can not contain spaces or other characters not suitable for use in URLs."));return false}if(a.toLowerCase()==="id"){alert(Joomla.JText._("The alias can not be ID (or id)."));return false}if(com_EasyTablePro.Tools.isNumber(a)||com_EasyTablePro.Tools.isNumber(a.charAt(0))){alert(Joomla.JText._("An alias can not be a number or start with a number."));return false}return true};com_EasyTablePro.Table.updateAlias=function(d){var a=d.name;var c="fieldalias"+a.substring(5);var b=document.getElementById(c);if(b.value===""){b.value=com_EasyTablePro.Tools.makeURLSafe(d.value)}if(b.value.toLowerCase()==="id"){b.value="tmpFldID";alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_AN_ALIAS_CAN_NOT_BE_ID"))}};com_EasyTablePro.Table.createTableNameAlias=function(){var a=document.getElementById("jform_easytablealias");var b=document.getElementById("jform_easytablename");if(a.value===""){a.value=com_EasyTablePro.Tools.makeURLSafe(b.value)}};com_EasyTablePro.Table.validateTableNameAlias=function(){var a=document.getElementById("jform_easytablealias");et_name=document.getElementById("jform_easytablename");if(a.value===""&&et_name.value!==""){a.value=com_EasyTablePro.Tools.makeURLSafe(et_name.value)}if(!this.aliasOK(a.value)){a.value=com_EasyTablePro.Tools.makeURLSafe(a.value);alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_TABLE_ALIAS_CHARACTERS"));return false}return true};com_EasyTablePro.Table.validateAlias=function(d){var a=d.value;var c;var b;if(a===""){c="label"+d.name.substring(10);b=$(c);d.value=com_EasyTablePro.Tools.makeURLSafe(b.value);alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_AN_ALIAS_CAN_NOT_BE_EMPTY"));return}if(a.toLowerCase()==="id"){c="label"+d.name.substring(10);b=$(c);if(b.value!=="id"){d.value=com_EasyTablePro.Tools.makeURLSafe(b.value)}else{d.value="tmpFldID"}alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_AN_ALIAS_CAN_NOT_BE_ID"));return}if(!this.aliasOK(d.value)){d.value=com_EasyTablePro.Tools.makeURLSafe(d.value);alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_FIELD_ALIAS_CHARACTERS"));return}};com_EasyTablePro.Table.addField=function(){if(typeof jQuery==="undefined"){var g='<input type="hidden" name="id#id#" value="#id#">#id#<br /><a href="javascript:void(0);" class="deleteFieldButton" onclick="com_EasyTablePro.Table.deleteField(\'#id#\', \'et_rID#id#\');"><img src="/media/com_easytablepro/images/publish_x.png"></a>';var i='<input type="text" value="9999" size="3" name="position#id#">';var d='<input type="text" value="" name="label#id#" id="label#id#" onclick="com_EasyTablePro.Table.updateAlias(this);" onblur="com_EasyTablePro.Table.updateAlias(this);"><br /><input type="hidden" name="origfieldalias#id#" value=""><input type="text" name="fieldalias#id#" id="fieldalias#id#" value="" onchange="com_EasyTablePro.Table.validateAlias(this)" disabled=""><img src="/media/com_easytablepro/images/locked.gif" onclick="com_EasyTablePro.Table.unlock(this, \'#id#\');" id="unlock#id#">';var w='<textarea cols="30" rows="2" name="description#id#"></textarea>';var m='<select name="type#id#"><option value="0" selected="">'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_LABEL_TEXT")+'</option><option value="1">'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_LABEL_IMAGE")+'</option><option value="2">'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_LABEL_LINK_URL")+'</option><option value="3">'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_LABEL_EMAIL_ADDRESS")+'</option><option value="4">'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_LABEL_NUMBER")+'</option><option value="5">'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_LABEL_DATE")+'</option></select><br /><input type="hidden" name="origfieldtype#id#" value=""><input type="text" value="" name="fieldoptions#id#">';var f='<input type="hidden" name="list_view#id#" value="0"><a href="javascript:void(0);" onclick="com_EasyTablePro.Table.toggleTick(\'list_view\', \'#id#\');"><img src="/media/com_easytablepro/images/publish_x.png" name="list_view#id#_img" border="0" title="'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_CLICK_LIST_VIEW_BTN_TT")+'"></a>';var j='<input type="hidden" name="detail_link#id#" value="0"><a href="javascript:void(0);" onclick="com_EasyTablePro.Table.toggleTick(\'detail_link\', \'#id#\');"><img src="/media/com_easytablepro/images/publish_x.png" name="detail_link#id#_img" border="0" title="'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_CLICK_DETAIL_LINK_BTN_TT")+'"></a>';var r='<input type="hidden" name="detail_view#id#" value="0"><a href="javascript:void(0);" onclick="com_EasyTablePro.Table.toggleTick(\'detail_view\', \'#id#\');"><img src="/media/com_easytablepro/images/publish_x.png" name="detail_view#id#_img" border="0" title="'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_CLICK_SHOW_DETAIL_VIEW_TT")+'"></a>';var z='<input type="hidden" name="search_field#id#" value="0"><a href="javascript:void(0);" onclick="com_EasyTablePro.Table.toggleTick(\'search_field\', \'#id#\');"><img src="/media/com_easytablepro/images/publish_x.png" name="search_field#id#_img" border="0" title="'+Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_CLICK_TO_MAKE_SEARCHABLE_TT")+'"></a>';var t=this.newFldID();var c=document.createElement("tr");c.setAttribute("align","center");c.setAttribute("class","et_new_row");c.setAttribute("id","et_rID"+t);var h=$("et_meta_table_rows");var n=$("et_controlRow");var u=new Element("td",{align:"center"});u.innerHTML=g.split("#id#").join(t);var q=new Element("td",{align:"center"});q.innerHTML=i.split("#id#").join(t);var v=new Element("td",{align:"left"});v.innerHTML=d.split("#id#").join(t);var l=new Element("td",{align:"center"});l.innerHTML=w.split("#id#").join(t);var o=new Element("td",{align:"left"});o.innerHTML=m.split("#id#").join(t);var a=new Element("td",{align:"center"});a.innerHTML=f.split("#id#").join(t);var y=new Element("td",{align:"center"});y.innerHTML=j.split("#id#").join(t);var b=new Element("td",{align:"center"});b.innerHTML=r.split("#id#").join(t);var s=new Element("td",{align:"center"});s.innerHTML=z.split("#id#").join(t);u.injectInside(c);q.injectAfter(u);v.injectAfter(q);l.injectAfter(v);o.injectAfter(l);a.injectAfter(o);y.injectAfter(a);b.injectAfter(y);s.injectAfter(b);h.insertBefore(c,n)}else{var e=jQuery("#et_clone_new_row");var p=e.clone();p.removeClass("et_clone_new_row");p.addClass("et_new_row");var k=jQuery("#et_fieldList tbody tr").length;if(com_EasyTablePro.Tools.isEven(k)){p.addClass("row0")}else{p.addClass("row1")}var x=this.newFldID();this.setRowIDandValues(p,x);e.before(p)}};com_EasyTablePro.Table.newFldID=function(){var c=$("newFlds");var a;var b;if(c.value===""){a="_nf_1";c.value="1"}else{b=this.firstAvailableNumber(c.value);a="_nf_"+b;c.value=com_EasyTablePro.Tools.addToList(c.value,b)}return a};com_EasyTablePro.Table.setRowIDandValues=function(b,n){b.attr("id","et_rID"+n);var t=b.find('[name="idclone"]');t.val(n);t.attr("name","id"+n);var i=b.find(".et_nf_id");i.text(n);var c=b.find('[name="positionclone"]');c.attr("name","position"+n);var u=b.find('[name="labelclone"]');u.attr("id","label"+n);u.attr("name","label"+n);var q=b.find('[name="origfieldaliasclone"]');q.attr("name","origfieldalias"+n);var r=b.find('[name="fieldaliasclone"]');r.attr("id","fieldalias"+n);r.attr("name","fieldalias"+n);var p=b.find("#unlockclone");p.attr("id","unlock"+n);var y=b.find('[name="descriptionclone"]');y.attr("name","description"+n);var w=b.find('[name="typeclone"]');w.attr("name","type"+n);var d=b.find('[name="origfieldtypeclone"]');d.attr("name","origfieldtype"+n);var k=b.find('[name="fieldoptionsclone"]');k.attr("name","fieldoptions"+n);var e=b.find('[name="list_viewclone"]');e.attr("name","list_view"+n);var l=b.find("#listViewclone");l.attr("id","list_view.btn."+n);var x=b.find('[name="list_viewclone_img"]');x.attr("name","list_view"+n+"_img");var s=b.find('[name="detail_linkclone"]');s.attr("name","detail_link"+n);var v=b.find("#detailLinkclone");v.attr("id","detail_link.btn."+n);var g=b.find('[name="detail_linkclone_img"]');g.attr("name","detail_link"+n+"_img");var o=b.find('[name="detail_viewclone"]');o.attr("name","detail_view"+n);var m=b.find("#detailViewclone");m.attr("id","detail_view.btn."+n);var j=b.find('[name="detail_viewclone_img"]');j.attr("name","detail_view"+n+"_img");var f=b.find('[name="search_fieldclone"]');f.attr("name","search_field"+n);var h=b.find("#searchclone");h.attr("id","search_field.btn."+n);var a=b.find('[name="search_fieldclone_img"]');a.attr("name","search_field"+n+"_img")};com_EasyTablePro.Table.deleteField=function(i,e){var k=e.substring(6);var j;if((k.length>4)&&(k.substring(0,4)==="_nf_")){j=false}else{j=true}if(j){var f=confirm(com_EasyTablePro.Tools.sprintf(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_DELETING_FIELD"),i,i));if(f){var a=$("deletedFlds");var b=$("mRIds");var d=$(e);d.style.display="none";j=true;if(a.value!==""){a.value=com_EasyTablePro.Tools.addToList(a.value,k)}else{a.value=k}b.value=com_EasyTablePro.Tools.deleteFromList(b.value,k)}}else{var c=k.substring(4);var g=$("newFlds");if(g.value===c){g.value=""}else{g.value=com_EasyTablePro.Tools.deleteFromList(g.value,c)}var h=$("et_meta_table_rows");var l=$(e);h.removeChild(l)}};Joomla.submitbutton=function(a){switch(a){case"table.cancel":Joomla.submitform(a);break;case"modifyTable":com_EasyTablePro.Table.toggleModifyControls();return 0;case"table.apply":case"table.save":case"table.save2new":com_EasyTablePro.Table.save(a);break;case"table.updateETDTable":case"table.createETDTable":com_EasyTablePro.Table.upload();break;default:alert(com_EasyTablePro.Tools.sprintf(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_OK_YOU_BROKE_IT"),a));return 0}};com_EasyTablePro.Table.etSubmitForm=function(a){var c=document.adminForm;var e=c.elements.length;var d;for(var b=0;b<e;b++){d=c.elements[b];if(d.disabled){d.disabled=false}}Joomla.submitform(a)};com_EasyTablePro.Table.save=function(a){if(document.adminForm.id.value===0){alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_THIS_TABLE_REQUIRES_DATA"));return 0}if(!com_EasyTablePro.Table.atLeast1ListField()){alert($et_check_msg);return 0}if(!this.validateTableNameAlias()){return 0}if(!com_EasyTablePro.Table.AliassAreUnique()){alert($et_check_msg);return 0}com_EasyTablePro.Table.etSubmitForm(a)};com_EasyTablePro.Table.upload=function(){var c=document.adminForm.tablefile.value;var b=c.lastIndexOf(".");if(b===-1){alert(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_ONLY_CSV_OR_TAB_FILES"));return 0}var a=c.substr(b,c.length);a=a.toLowerCase();if((a!==".csv")&&(a!==".tsv")){alert(com_EasyTablePro.Tools.sprintf(Joomla.JText._("COM_EASYTABLEPRO_TABLE_JS_WARNING_ONLY_TAB_CSV"),a));return 0}};com_EasyTablePro.Table.toggleModifyControls=function(){if($("et_controlRow").hasClass("et_controlRow-nodisplay")){$("et_controlRow").addClass("et_controlRow");$("et_controlRow").removeClass("et_controlRow-nodisplay");$$(".deleteFieldButton-nodisplay").addClass("deleteFieldButton");$$(".deleteFieldButton").removeClass("deleteFieldButton-nodisplay");com_EasyTablePro.Tools.disableToolbarBtn("toolbar-popup-easytablpro-uploadTable",Joomla.JText._("COM_EASYTABLEPRO_TABLE_UPLOAD_DISABLED_TABLE_MODIFIED_MSG"))}else{$("et_controlRow").addClass("et_controlRow-nodisplay");$("et_controlRow").removeClass("et_controlRow");$$(".deleteFieldButton").addClass("deleteFieldButton-nodisplay");$$(".deleteFieldButton-nodisplay").removeClass("deleteFieldButton")}};com_EasyTablePro.Table.flipAll=function(c){if(c===null){c="list"}var e=$("mRIds").value.split(", ");var d=e.length;var b;switch(c){case"list":case"detail":b=c+"_view";break;case"search":b=c+"_field"}for(var a=0;a<d;a++){this.toggleTick(b,e[a])}};com_EasyTablePro.Table.turnAll=function(OnOrOff,inView){var tFNNShouldBe;var tRow;var tFNN;if(OnOrOff===null){OnOrOff="on"}if(OnOrOff==="on"){tFNNShouldBe=1}else{tFNNShouldBe=0}if(inView===null){inView="list"}var allFields=$("mRIds").value.split(", ");var allFieldsLn=allFields.length;var tFieldName;switch(inView){case"list":case"detail":tFieldName=inView+"_view";break;case"search":tFieldName=inView+"_field"}for(var i=0;i<allFieldsLn;i++){tRow=allFields[i];tFNN=parseInt(eval("document.adminForm."+tFieldName+tRow+".value"));if(tFNN!==tFNNShouldBe){this.toggleTick(tFieldName,tRow)}}};com_EasyTablePro.Table.ShowTip=function(a){document.getElementById(a).style.display="block"};com_EasyTablePro.Table.HideTip=function(a){document.getElementById(a).style.display="none"};